% !TeX spellcheck = en_US
\section{Problem 4}

In this problem, we will express the derivatives in respect to the matching activation function.

\subsection{LogSig}

This activation function is expressed as
\[
S(x) = \dfrac{1}{1 + e^{-x}}
\]
Multiplying itself with $\left(1 + e^{-x}\right)$ gives
\[
\left(1 + e^{-x}\right) \MathSpace S(x) = 1 \Leftrightarrow e^{-x} = \frac{1}{S(x)} - 1
\]
So, activation function's derivative will be
\[
\begin{aligned}[c]
\dfrac{dS}{dx} &= \dfrac{d\left(\left(1+e^{-x}\right)^{-1}\right)}{dx} = \left(1+e^{-x}\right)^{-2} \MathSpace e^{-x} = S^2(x) \MathSpace \left(\dfrac{1}{S(x)} -1 \right) \\
&= S(x) - S^2(x) = S(x) \MathSpace \left( 1 - S(x) \right)
\end{aligned}
\]

\subsection{TanSig}

Activation function is 
\[
S(x) = \dfrac{e^x - e^{-x}}{e^x + e^{-x}}
\]

Its derivative is 
\begin{equation}
\begin{gathered}
\frac{dS}{dx} = \dfrac{\left(e^x +e^{-x} \right)\left(e^x +e^{-x} \right) - \left(e^x - e^{-x} \right)\left(e^x - e^{-x} \right)}{\left(e^x + e^{-x} \right)^2} = \\
= \dfrac{\left( e^x + e^{-x} \right)^2 - \left( e^x - e^{-x} \right)^2}{\left( e^x + e^{-x} \right)^2} = 1- \left(\dfrac{e^x - e^{-x}}{e^x + e^{-x}}\right)^2 = 1 - S^2(x)
\end{gathered}
\end{equation}

\subsection{Swish}

Activation function is
\[
S(x) = \dfrac{x}{1 + e^{-x}}
\]
The derivative in respect to $x$ is 
\[
\begin{gathered}
\frac{dS}{dx} = \dfrac{1 + e^{-x} + x e^{-x}}{\left( 1 + e^{-x} \right)^2} = \frac{1 + e^{-x}}{\left( 1 + e^{-x} \right)^2} + \frac{xe^{-x}}{\left( 1 + e^{-x} \right)^2} = \frac{1}{1+e^{-x}} + x \frac{e^{-x}}{\left( 1 + e^{-x} \right)^2}
\end{gathered}
\]
Rewriting the function gives us
\[
\frac{S(x)}{x} = \frac{1}{1 + e^{-x}} \quad \text{and} \quad e^{-x} = \frac{x-S(x)}{S(x)}
\]

So, continuing with the derivative:
\[
\begin{gathered}
\frac{dS}{dx} = \frac{1}{1+e^{-x}} + x \frac{e^{-x}}{\left( 1 + e^{-x} \right)^2} = \frac{S(x)}{x} + \frac{e^{-x}}{1+e^{-x}} \frac{x}{1+e^{-x}} = \frac{S(x)}{x} + S(x) \frac{x}{1+e^{-x}} = \\ 
= \frac{S(x)}{x} + S(x) \frac{S(x)}{x} e^{-x} = \frac{S(x)}{x} \left( 1 + S(x) e^{-x} \right) = \frac{S(x)}{x} \left( 1 + S(x)\frac{x-S(x)}{S(x)} \right) = \\
= \frac{S(x)}{x} \left( 1 + x - S(x) \right) = \frac{S(x)}{x} + S(x) - \frac{S^2(x)}{x}
\end{gathered}
\]
Let $\sigma = \dfrac{1}{1 + e^{-x}}$, thus 
\begin{equation}
\frac{dS}{dx} = \frac{S(x)}{x} + S(x) - \frac{S^2(x)}{x} = \sigma + S(x) - \sigma S(x) = S(x) + \sigma \left( 1 - S(x) \right)
\end{equation}

\subsection{Custom tanh}

Activation function is
\[
S(x) =  x \MathSpace \tanh\left(\ln\left(1+e^x\right)\right) = x \MathSpace \tanh\left(g(x)\right), \ \text{where} \ g(x) = \ln\left(1+e^x\right).
\]

By calculating the derivative of this function as is, we get 
\[
\begin{gathered}
\frac{dS}{dx} = \tanh(g(x)) + x \ \tanh^{'} (g(x)) \ \frac{dg}{dx} = \tanh(g(x)) + x\ \tanh^{'} (g(x)) \ \frac{1}{1+e^{-x}} =\\ 
= \tanh(g(x)) + \tanh^{'} (g(x)) \ x\ \frac{\text{Swish}(x)}{x} = \frac{S(x)}{x} + \tanh^{'} (g(x)) \ \text{Swish}(x) = \\
= \frac{S(x)}{x} + (1 - \tanh^{2} (g(x))) \ \text{Swish}(x) = \frac{S(x)}{x} + \text{Swish}(x) - \tanh^{2} (g(x)) \ \text{Swish}(x)
\end{gathered}
\]
So, the derivative is 
\begin{equation}
%\begin{gathered}
\frac{dS}{dx} = \frac{S(x)}{x} + \text{Swish}(x) - \frac{S^2(x)}{x^2} \ \text{Swish}(x)
%\end{gathered}
\end{equation}
where $S(x)$ is the activation function and Swish$(x)$ is the Swish activation function from before.